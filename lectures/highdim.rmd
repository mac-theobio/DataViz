---
title: "high-dimensional data"
bibliography: ../vis.bib
date: Oct 2021
---

## packages

Some of these packages may be hard to install, i.e. depending on system resources (especially `rggobi`).

```{r pkgs, message=FALSE}
library(tourr)
## archived: use remotes::install_version("rggobi", "2.1.22")
## or remotes::install_github("ggobi/rggobi")
## see the github repository https://github.com/ggobi/rggobi
## and the ggobi web site: http://ggobi.org/
library(rggobi)
library(factoextra)
library(pheatmap)
library(tidyverse)
```

## @buja_interactive_1996

- scatterplots (point locations)
- traces (functions: parallel coordinates, [Andrews plots](https://en.wikipedia.org/wiki/Andrews_plot))
- glyphs (stars/radar charts/faces/etc.)

## tasks

* finding gestalt: focusing views (projection)
* posing queries: brushing/linking
* making comparisons: arranging many views

## focusing: animation/motion

* adds a dimension (2D to 3D)
* smoothness/object continuity
* real-time user control: allows user to search/tune

## interactive example

```{r ggobi_laser,eval=FALSE}
ggobi(laser)
```

## tours

three components:

- data matrix ($n \times p$)
- **tour path** that produces a smooth sequence of projection matrices ($p \times d$)
- **display method** that renders the projected data.

Goal: allow automated, systematic search through **entire** space of projections

---

```{r tour_laser,eval=FALSE}
animate_xy(laser)
```

## available display methods

```{r}
apropos("animate_")
```

## PCA

Examples/data from @holmes_modern_2019

- `prcomp` (SVD): preferred (also `princomp` ??)
- same data; projects in a way that (hopefully) focuses on interesting angles in the data
- assumes linear features
- normality not necessary, but better-behaved with normal data

---

## wine PCA example

```{r wine1}
load("../data/wine.RData")
load("../data/wineClass.RData")

winePCAd = prcomp(wine,scale=TRUE) ## compute PCA
f0 <- fviz_pca_biplot(winePCAd, geom = "point", habillage = wine.class,
                      col.var = "violet", addEllipses = TRUE, ellipse.level = 0.69) +
  ggtitle("") + coord_fixed() +
  scale_colour_brewer(palette="Dark2") +
  scale_fill_brewer(palette="Dark2")
## make augmented data we can use
aug_data <- (get_pca_ind(winePCAd)$coord
  %>% as_tibble()
  %>% mutate(class=wine.class)
)
```

## plot

```{r plot_wine1}
print(f0)
```

## improved plot

```{r plot_wine2,message=FALSE}
f1 <- fviz_pca_biplot(winePCAd, geom = "point", habillage = wine.class,
   col.var = "violet") + ggtitle("") + coord_fixed() +
  scale_colour_brewer(palette="Dark2") +
  scale_fill_brewer(palette="Dark2")
names(ggplot_build(f1)$data[[1]])
f2 <- f1 + ggalt::geom_encircle(data=aug_data,
                          aes(x=Dim.1,y=Dim.2,group=class,
                              colour=class,
                              fill=class),alpha=0.2,
                          show.legend=FALSE)

```

--- 

```{r print_wineplot2}
print(f2)
```

## challenges

- categorical/compositional data
- random forest viz?

## references

